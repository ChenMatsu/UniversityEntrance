京都大学　大学院情報学研究科　2018年度博士前期課程入試問題　確率・統計

**問題２**　あるコインを投げると, 確率 $p (0 < p < 1)$ で表す, 確率  $q (=1-p)$ で裏が出る. このコインを表が出るまで連続して投げ続ける. ただし, 毎回のコイン投げは独立な試行である. 初めて表が出るまでに投げた回数（表が出た試行を含む）を確率変数 $T$ で表す以下の設問に答えなさい.

(1) $T = n \space (n = 1,2,...)$ となる確率 $P(T=n)$ を求めなさい. ただし, $P(\cdot)$ は確率を表す.

$$
    \begin{align*}
        P(T = n) = (1-p)^{n-1}q
    \end{align*}
$$

(2) 確率変数 $T$ の期待値（平均）と分散を求めなさい.

$$
    \begin{align*}
        E[X] & = \sum_{k=0}^{∞}k(1-p)^{k-1}p = p\sum_{k=0}^{∞}(1-p)^k \\\
        & = \dfrac{p}{(1-(1-p))^2} = \dfrac{1}{p}
    \end{align*}
$$

$$
    \begin{align*}
        E[X^2] & = \sum_{k=0}^{∞}k^2(1-p)^{k-1}p = p\sum_{k=0}^∞k^2(1-p)^{k-1} \\\ 
        & = \dfrac{2}{p^2} \quad (\sum_{k=0}^∞x^k = \dfrac{1}{1-x})
    \end{align*}
$$

$$
    \begin{align*}
        V[X] = E[X^2] - (E[X])^2 = \dfrac{2}{p^2} - (\dfrac{1}{p})^2 = \dfrac{1}{p^2}
    \end{align*}
$$

あるスロットマシン（窓は一つとする）を引くと, $m$ 種類（ $m=1,2,..$ ）の異なる図柄が等確率で出る. 便宜上, $m$ 種類の図柄のそれぞれに $\{1,2,...,m\}$ の異なる番号を付ける. このスロットマシンを連続して引くことを考える, $n$ 回目（ $n=1,2,...$ ）に引いた際に出た図柄の番号を確率変数 $X_n \in \{1,2,...,m\}$ で表す. ただし, スロットマシンを引く試行は独立である. この時, $m$ 種類の図柄のうち異なる図柄が初めて $i$ 種類（ $i=1,2,...,m$ ） になるまでスロットマシンを引いた回数を $T_{m,i}$ と表すと,

$$
    T_{m,i} = \begin{cases} 1 \quad (i=1) \\\ min \space \{n > T_{m,i-1} | X_n \ne X_j; j = 1,...,n-1 \} & (i=2,...,m) \end{cases}
$$

と再帰的に定義できる. 以下の設問に答えなしさい.

(3) 確率変数 $U_{m,i} (i=2,...,m)$ として, 

$$
    U_{m,i} \equiv T_{m,i} - T_{m,i-1}
$$

とする. $U_{m,i} = k (k=1,2,...)$ となる確率 $P(U_{m,i}=k)$ を求めなさい.

$$
    \begin{align*}
        P(U_{m,i} = k) & = P(( T_{m,i} - T_{m,i-1}) = k) \\\
        & = (\dfrac{i}{m})^{k-1}(\dfrac{m-i}{m})
    \end{align*}
$$

(4) すべての図柄が初めて出るまでスロットマシンを引いた回数 $T_{m,m}$ に対して, その期待値（平均）が以下の式で与えられることを示しなさい.

$$
    1 + m\sum_{j=1}^{m-1}\dfrac{1}{j}
$$

$$
    \begin{align*}
        \sum_{i=2}^mU_{m,i} & = \sum_{i=2}^m(T_{m,i} - T_{m,i-1}) \\\
        & = -T_{m,1} + T_{m,m} = -1 + T_{m,m}
    \end{align*}
$$

$$
    \begin{align*}
        T_{m,m} = 1 + \sum_{i=2}^mU_{m,i} = 1 + \sum_{i=1}^{m-1}U_{m,i}
    \end{align*}
$$

$$
    \begin{align*}
        E[T_{m,m}] & = 1 + \sum_{i=1}^{m-1}E[U_{m,i}] \\\
        & = 1 + \sum_{i=1}^{m-1}\dfrac{m}{m-i} \\\
        & = 1 + m\sum_{i=1}^{m-1}\dfrac{1}{m-i} \\\
        & \equiv 1 + m\sum_{j=1}^{m-1}\dfrac{1}{j}
    \end{align*}
$$
