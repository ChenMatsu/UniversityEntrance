京都大学　大学院情報学研究科　2019年度博士前期課程入試問題　確率・統計

**問題２**　袋の中に $N(N = 1,2,...)$ 個のボールがあり, そのうち $m (m \in \{0,1,...,N\})$ 個は赤色, 残りは白色である. 袋から, ランダムかつ同時に $n(n \in \{1,...,N\})$ 個取り出した際にその中で赤色であるボールの個数を確率変数 $X(X \in \{0,1,...,n\})$ で表すことにする. 以下の設問(1),(2)に答えなさい.

(1) $X = k(k=0,1,...,n)$ となる確率 $P(X=k)$ を求めなさい.

$$
    \begin{align*}
        P(X = k) = C_k^n(\dfrac{m}{N})^k(1 - \dfrac{m}{N})^{n-k}
    \end{align*}
$$

(2) 確率変数 $X$ の期待値を求めなさい.

$$
    \begin{align*}
        E[X] & = \sum_{k=0}^nxP(X=k) \\\
        & = \sum_{k=0}^nkC_k^n(\dfrac{m}{N})^k(1 - \dfrac{m}{N})^{n-k} \\\
        & = \sum_{k=0}^nnC_{k-1}^{n-1}(\dfrac{m}{N})^k(1 - \dfrac{m}{N})^{n-k} \\\
        & = n(\dfrac{m}{N})\sum_{k=1}^nC_{k-1}^{n-1}(\dfrac{m}{N})^{k-1}(1 - \dfrac{m}{N})^{n-k} \\\
        & = n(\dfrac{m}{N})\sum_{l=0}^{n-1}C_{l}^{n-1}(\dfrac{m}{N})^l(1 - \dfrac{m}{N})^{n-l-1} \\\
        & = \dfrac{nm}{N}
    \end{align*}
$$

袋の中に白いボールが多数入っている. その個数が分からないので未知パラメーだ $N$ とおき, これを以下の手続で見積もることにした. まず, 袋の中からランダムかつ同時に $m$ 個を取り出し赤く塗った. それらを袋に戻しよくかき混ぜた. その後, 今度は袋の中からランダムかつ同時に $n$ 個のボールを取り出したところ, そのうち $k(k \in \{0,1,...,n\})$ 個が赤く塗られていた. $N,m,n$ は正の整数である. 以下の設問(3)~(5)に答えなさい.

(3) $N$ に関する尤度 $L(N)$ を求めなさい.

$$
    \begin{align*}
        L(N) = P(X = k | N) =  C_k^n(\dfrac{m}{N})^k(1 - \dfrac{m}{N})^{n-k}
    \end{align*}
$$

(4) 設問(3)の $L(N)$ について, $L(N)/L(N-1)$ (ただし $N=2,3,...$ ) を計算しなさい.

$$
    \begin{align*}
        \dfrac{L(N)}{L(N-1)} = \dfrac{(N-1)^n}{(N)^n} \cdot \dfrac{(N-m)^{n-k}}{(N-1-m)^{n-k}}
    \end{align*}
$$

(5) $N$ の最尤推定値を求めなさい. ただし $k \ge 1$ とする.

$$
    \begin{align*}
        & \ln(L) = \ln(C_k^n) + k\ln{\dfrac{m}{N}} + (n-k)\ln(1 - \dfrac{m}{N}) \\\
        & \dfrac{∂\ln(L)}{∂N} = \dfrac{-k}{N} + (n-k)(\dfrac{1}{N-m} - \dfrac{1}{N}) \\\
        & N = \dfrac{nm}{k} =: \hat{N}
    \end{align*}
$$