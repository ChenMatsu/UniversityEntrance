京都大学　大学院情報学研究科　2019年度博士前期課程入試問題　確率・統計

**問題１**　確率変数 $Z_i = (X_i, Y_i), i = 1,...,n$ は独立に次のように定義される確率分布に従う. 各 $X_i, Y_i$ は $0$ または $1$ を値に取り, $P(X_i = 1) = α, P(Y_i = 1| X_i) = βX_i$ とする（一般に $X_i$ と $Y_i$ は独立ではない）. ただし $n$ は正の整数, $0 < α < 1, 0 < β < 1$ は未知パラメータである. このとき以下の設問に答えなさい.

(1) 同時確率 $P(X_i = x, Y_i = y)$ を $(x,y)$ の取りうるすべての値について求めなさい. ただし $α, β$ を用いること.

$$
    \begin{align*}
        & (x,y) = \{(0,0),(0,1),(1,0),(1,1)\} \\\
        & P(Y_i=y|X_i) = \dfrac{P(Y_i=y \cap X_i = x)}{P(X_i=x)} \\\
        & P(Y_i = y \cap X_i = x) = P(Y_i = y | X_i)P(X_i = x)
    \end{align*}
$$

$$
    \begin{align*}
        & P(X_i = 0 \cap Y_i = 0) = P(X_i = 0)P(Y_i = 0 | X_i = 0) = (1 - α) \cdot 1   \\\
        & P(X_i = 0 \cap Y_i = 1) = P(X_i = 0)P(Y_i = 1 | X_i = 0) = (1 - α) \cdot 0  \\\
        & P(X_i = 1 \cap Y_i = 0) = P(X_i = 1)P(Y_i = 0 | X_i = 1) = α \cdot  (1 - β) \cdot 1 \\\
        & P(X_i = 1 \cap Y_i = 1) = P(X_i = 1)P(Y_i = 1 | X_i = 1) = α \cdot β \cdot 1
    \end{align*}
$$

> $P(X_i = 1) = α, P(Y_i = 1| X_i) = βX_i$ holds only when $X_i = 1$

(2) $Z_i, i = 1,...,n$ をすべて用いて, $α, β$ の最尤推定量 $\hat{α_n}, \hat{β_n}$ を求めなさい.

$$
    \begin{align*}
        L(z_1,z_2,...,z_n|(α, β)) = \Pi_{i=1}^n(1 - α)^{(1 - X_i)(1 - Y_i)}(αβ)^{X_iY_i}[α(1 - β)]^{X_i(1 - Y_i)}
    \end{align*}
$$

$$
    \begin{align*}
        \ln(L(z_1,z_2,...,z_n|(α, β))) & = \sum_{i=1}^n[(1 - X_i)(1 - Y_i)\ln(1 - α) + X_iY_i\ln(αβ) + X_i(1 - Y_i)\ln(α(1 - β))] \\\
        & = \sum_{i=1}^n[(1 - X_i)(1 - Y_i)\ln(1 - α) + X_iY_i(\ln(α) + \ln(β)) + X_i(\ln(α) + \ln(1 - β)) - X_iY_i(\ln(α) + \ln(1 - β))] \\\
        & = \sum_{i=1}^n[(1 - X_i)(1 - Y_i)\ln(1 - α) + X_iY_i\ln(β) + X_i\ln(α) + X_i(1 - Y_i)\ln(1 - β)]
    \end{align*}
$$

$$
    \begin{align*}
        \dfrac{∂\ln(L)}{∂α} & = \sum_{i=1}^n[\dfrac{(1 - X_i)(1 - Y_i)}{α - 1} + \dfrac{X_i}{α}] \\\
        & = \dfrac{1}{α - 1}\sum_{i=1}^n(1 - X_i)(1 - Y_i) + \dfrac{1}{α}\sum_{i=1}^nX_i = 0 \\\
        & \to α\sum_{i=1}^n(1 - X_i)(1 - Y_i) + (α - 1)\sum_{i=1}^nX_i = 0 \\\
        & α = (\sum_{i=1}^nX_i)/(\sum_{i=1}^n(1 - X_i)(1 - Y_i) + \sum_{i = 1}^n X_i) = \hat{α}
    \end{align*}
$$

$$
    \begin{align*}
        \dfrac{∂\ln(L)}{∂β} & = \sum_{i=1}^n[\dfrac{X_iY_i}{β} + \dfrac{X_i(1 - Y_i)}{β - 1}] \\\
        & = \dfrac{1}{β}\sum_{i=1}^nX_iY_i + \dfrac{1}{β - 1}\sum_{i=1}^nX_i(1 - Y_i) = 0 \\\
        & \to (β - 1)\sum_{i=1}^nX_iY_i + β\sum_{i=1}^nX_i(1 - Y_i) = 0 \\\
        & β = (\sum_{i=1}^nX_iY_i)/(\sum_{i=1}^nX_i(1 - Y_i) + \sum_{i = 1}^n X_iY_i) = \hat{β}
    \end{align*}
$$


(3) 制約条件 $α + β = 1$ を仮定する. このとき, $Z_i, i = 1,...,n$ をすべて用いて, $α$ の最尤推定量 $\hat{α_n}$ を求めなさい.

$$

$$

(4) 設問(3)の $\hat{α_n}$ は極限 $n \to ∞$ においてある値に確率収束する. その値を求めなさい.