### 二次系
> 入力と出力の関係が2階の線形微分方程式で表現されるシステム

$$
  G(s) = \dfrac{K\omega_n^2}{s^2 + 2\zeta \omega_ns + \omega_n^2}
$$

$$\begin{align*}
  K = \dfrac{b_0}{a_0}\\
  \zeta = \dfrac{a_1}{2\sqrt{a_0a_2}} \ge 0\\
  \omega_n = \sqrt{\dfrac{a_0}{a_2}} > 0
\end{align*}$$

Kはゲイン、$\zeta$ は減衰係数、$\omega_n$ は固有角周波数と呼ばれる定数である。2次系の特性は、この３つの定数によって決まる。

システムの特性を表す重要なパラメタは**極**ということである。「伝達関数の分母=0」を解くと極が得られる。ルートの中身に注目すると、三つの場合として分けられる。

$$
  s^2 + 2\zeta \omega_ns + \omega_n^2 = 0
$$

$$
  s = -\omega_n\zeta \pm \omega_n\sqrt{\zeta^2 -1}
$$

1. $0 \le \zeta < 1$、システムは**複素極**を持つ（応答振動する）
  - $\zeta \uparrow$ 収束が速くなる  
3. $\zeta = 0$、システムは**単一の実極**を持つ（応答ギリギリ振動しない）
4. $\zeta > 1$、システムは**２つの実極**を持つ（応答振動しない
  - $\zeta \uparrow$ 収束が遅くなる  

**インパルス応答**

<p align="center">
    <img src="https://controlabo.com/wp-content/uploads/2020/12/2nd_order_system_impulse_response-1.png"/>
</p>

**インパルス応答**

<p align="center">
    <img src="https://controlabo.com/wp-content/uploads/2020/12/2nd_order_system_step_response.png"/>
</p>

---
**複素極の場合**
> $0 \le \zeta < 0$

**インパルス応答**

$$
  Y(s) = \dfrac{K\omega_n}{\sqrt{1 - \zeta^2}} * \dfrac{\sqrt{1 - \zeta^2}\omega_n}{(s + \zeta\omega_n)^2 + (1 - \zeta^2)\omega_n^2}
$$

$$
  y(t) = \mathscr{L^{-1}}[Y(s)] = \dfrac{K\omega_n}{\sqrt{1 - \zeta^2}}e^{-\zeta \omega_nt}sin(w_n\sqrt{1 - \zeta^2}t)
$$

<p align="center">
    <img src="https://controlabo.com/wp-content/uploads/2020/12/2nd_order_system_impulse_response_oscillate.png"/>
</p>

**ステップ応答**

$$
  Y(s) = G(s)U(s) = \dfrac{K\omega_n^2}{s^2 + 2\zeta \omega_ns + \omega_n^2} * \dfrac{1}{s}
$$

$$
  Y(s) = K(\dfrac{1}{s} - \dfrac{s + 2\zeta \omega_n}{s^2 + 2\zeta \omega_ns + \omega_n^2}) = K\{\dfrac{1}{s} - \dfrac{s + \zeta \omega_n}{(s + \zeta \omega_n)^2 + (\omega_n \sqrt{1 - \zeta^2})^2} - \dfrac{\zeta}{\sqrt{1 - \zeta^2}}* \dfrac{\omega_n \sqrt{1 - \zeta^2}}{(s + \zeta \omega_n)^2 + (\omega_n \sqrt{1 - \zeta^2})^2}\}
$$

$$
  y(t) = K\{1 - e^{-\zeta \omega_nt}cos(\omega_n \sqrt{1 - \zeta^2}t) - \dfrac{\zeta}{\sqrt{1 - \zeta^2}}sin(\omega_n \sqrt{1 - \zeta^2}t)\} = K\{1 - \dfrac{1}{\sqrt{1 - \zeta^2}}e^{-\zeta \omega_nt}sin(\omega_n \sqrt{1 - \zeta^2} + \phi)\}
$$

<p align="center">
    <img src="https://controlabo.com/wp-content/uploads/2020/12/2nd_order_system_step_response_oscillate.png"/>
</p>

**単一実極の場合**
> $\zeta = 1$

$$
  G(s) = \dfrac{K\omega_n^2}{(s + \omega_n)^2}
$$

**インパルス応答**

$$
  y(t) = \mathscr{L^{-1}}[G(s)U(s)] = K\omega_n^2te^{-\omega_nt}
$$

**ステップ応答**

$$
  y(t) = \mathscr{L^{-1}}[G(s)U(s)] =  \mathscr{L^{-1}}[K\{\dfrac{1}{s} - \dfrac{1}{s + \omega_n} - \dfrac{\omega_n}{(s + \omega_n)^2}\}] = K\{1 - (1 + \omega_nt)e^{-\omega_nt}\} 
$$

**２つ実極の場合**
> $\zeta > 1$

$$
  G(s) = \dfrac{1}{(s - p_1)(s-p_2)}
$$

$$
  p_1 = -\omega_n(\zeta - \sqrt{\zeta^2 - 1})\\
  p_2 = -\omega_n(\zeta + \sqrt{\zeta^2 - 1})\\
$$

**インパルス応答**

$$
  y(t) = \dfrac{K\omega_n}{2\sqrt{\zeta^2 - 1}}\{e^{-\omega_n(\zeta - \sqrt{\zeta^2 - 1})t} - e^{-\omega(\zeta + \sqrt{\zeta^2 - 1})t}\}
$$

**ステップ応答**

$$
  y(t) = K\{1 -  \dfrac{\zeta + \sqrt{\zeta^2 - 1}}{2\sqrt{\zeta^2 - 1}}e^{-\omega_n(\zeta - \sqrt{\zeta^2 -1})t} + \dfrac{\zeta - \sqrt{\zeta^2 - 1}}{2\sqrt{\zeta^2 - 1}}e^{-\omega_n(\zeta + \sqrt{\zeta^2 -1})t}\}
$$